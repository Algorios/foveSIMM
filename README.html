<html>
<body>
<pre>    
/* VERSION OF README FILE: 2017-04-19 *
 * (c) fovefi ltd
 * further info Manfred Kerber, make@fovefi.co 
 */

This directory contains eight files, re-implementing in Isabelle/HOL
OpenGamma's OpenSIMM and formally verifying some basic properties of
the SIMM. The 8 files are:

1. This README.html file, and the following Isabelle theory files:
2. Currency.thy, a simple encoding for three currencies (EUR, USD,
   GBP) in Isabelle (Isabelle is a generic proof assistant, for details,
   see, https://isabelle.in.tum.de/).
3. foveSIMM_Tests.thy, a few values computed from the implementation.
4. foveSIMM.thy, a file in which some examples are defined, risk values are
   summed up and verified scala code is extracted.
5. Percentile.thy, the bulk of the implementation, in which the Percentile
   function is formally defined, and important properties are proved.
6. Percentile2.thy is a variant for an experiment in which the
   definition of the Percentile function was changed (from a flat
   extension to a pessimistic extension). This resulted in changes
   in 10 lemmas and the need for 4 new lemmas. In 10 hours the
   changes were all made and the proofs adjusted.
7. A file foveSIMM_scala_src.zip, which contains three .scala files
   which are expanded in a directory foveSIMM_scala_src.
8. Slides explaining the approach.

At this moment, there are mainly two pieces of work to be done:
1. The implementation of the IR class does not yet agree with the
   OpenSIMM implementation.
2. The proofs of the final lemmas and theorem in Percentile.thy are not yet
   fully formalized and contain still some "sorry" statements.


foveSIMM_scala_src.zip expands to three files in a directory src:

1. foveSIMM_without_main.scala  (generated by Isabelle)
2. main.scala                   (written by hand to test the program)
3. foveSIMM.scala               (the first file with the added main method)

The binaries are obtained by compiling foveSIMM.scala (Compiling will
create more than 600 files) by:
scalac foveSIMM.scala  (within the directory)

The code can then be run by (again from within the directory):
scala foveSIMM

Note: There is a known problem using the extracted code using a
Windows operating system. Under Windows there is a name conflict with
the functions char and Char, since Windows does not distinguish
between lower- and uppercase words. This leads to problems when
compiling. In order to eliminate this, it is necessary to replace all
occurrences of "Char" by "cap_char" (or any other name which does not
lead to a conflict). Likewise replace "One" by "cap_one". This and
adding the hand-written main.scala to the foveSIMM.scala file are the
only changes needed and done in the file foveSIMM.scala.
</pre>
</body>
</html>
